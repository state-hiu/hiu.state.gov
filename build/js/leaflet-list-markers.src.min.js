function flyToStore(e){console.log("flytostore called"),map.flyTo(e._latlng,9)}var itemCount=1,globalProductsExist=!1;(function(){L.Control.ListMarkers=L.Control.extend({includes:L.Mixin.Events,options:{layer:!1,maxItems:500,collapsed:!1,label:"title",itemIcon:"",itemArrow:"&#10148;",maxZoom:9,position:"bottomleft"},initialize:function(e){L.Util.setOptions(this,e),this._container=null,this._list=null,this._layer=this.options.layer||new L.LayerGroup;for(var t in this._layer._layers){var i='<div class="title">'+this._layer._layers[t].feature.properties.title+"</div>",a={keepInView:!0,maxWidth:200};switch(this._layer._layers[t].bindPopup(i,a),this._layer._layers[t].setIcon(productIcon),this._layer._layers[t].feature.properties.region_id){case"AF":1==AFcount&&AFmarkers.addLayer(this._layer._layers[t]);break;case"EAP":1==EAPcount&&EAPmarkers.addLayer(this._layer._layers[t]);break;case"EUR":1==EURcount&&EURmarkers.addLayer(this._layer._layers[t]);break;case"NEA":1==NEAcount&&NEAmarkers.addLayer(this._layer._layers[t]);break;case"SCA":1==SCAcount&&SCAmarkers.addLayer(this._layer._layers[t]);break;case"WHA":1==WHAcount&&WHAmarkers.addLayer(this._layer._layers[t])}}},onAdd:function(e){this._map=e;var t=this._container=L.DomUtil.create("div","list-markers");return this._list=L.DomUtil.create("ul","list-markers-ul",t),this._initToggle(),e.on("moveend",this._updateList,this),this._updateList(),t},onRemove:function(e){console.log("onRemove called"),e.off("moveend",this._updateList,this),this._container=null,this._list=null},_createItem:function(e){var t=e.feature.properties.title,a=e._leaflet_id,o="<div>"+e.feature.properties.title+"</div>",s=document.createElement("div");if(s.className="container2",$(s).append('<div class="description-image"><a class="listitem-thumbnail" data-toggle="modal" data-target="#myModal" data-title="'+e.feature.properties.title+'"data-href= "#'+e.feature.properties.region_id+","+e.feature.properties.product_id+'" data-img="'+e.feature.properties.product_jpg+'" id="modal#'+e.feature.properties.region_id+","+e.feature.properties.product_id+'"><div id="img-container"><img class="img-responsive" src="'+e.feature.properties.thumbnail_300+'" width="150" height="150" style="border:1px solid #021a40;"><div id="hover"><span id="preview" style="line-height: 150px;">Preview</span></div></a></div></div><div class="description-text">Published date: <br>'+e.feature.properties.date_published+'<br><div class="dropdown" style="display: inline-block;padding-top: 10px;"><button class="btn btn-primary dropdown-toggle" style="padding: 3px 10px;" type="button" data-toggle="dropdown">Download<span class="caret"></span></button><ul class="dropdown-menu"><li><a class="pdf" onclick="ga(&apos;send&apos;, &apos;event&apos;, { eventCategory: &apos;product&apos;, eventAction: &apos;download - PDF&apos;, eventLabel: &apos;#'+e.feature.properties.region_id+","+e.feature.properties.product_id+'&apos;, transport: &apos;beacon&apos; });" href="'+e.feature.properties.product_pdf+'">PDF</a></li><li><a class="jpg" onclick="ga(&apos;send&apos;, &apos;event&apos;, { eventCategory: &apos;product&apos;, eventAction: &apos;download - JPG&apos;, eventLabel: &apos;#'+e.feature.properties.region_id+","+e.feature.properties.product_id+'&apos;, transport: &apos;beacon&apos; });" href="'+e.feature.properties.product_jpg+'">JPG</a></li></ul><a href="https://twitter.com/intent/tweet?text='+encodeURIComponent(e.feature.properties.tweet)+"&via=StateHIU&url=https://hiu.state.gov/%23"+e.feature.properties.region_id+"%2C"+e.feature.properties.product_id+'" class="tweet" target="_blank"><img src="/assets/img/Twitter_Logo_Blue.png" style="width: 40px;margin-left:15px"></a></div></div>'),e.feature.properties.region_id==activeLayer){var r=document.getElementById(activeLayer+"-listings"),r=r.appendChild(document.createElement("div"));if(r.className="item",r.title=t,r.id="item-"+a,"global"==activeLayer){var n=r.appendChild(document.createElement("a"));n.id="modal#"+e.feature.properties.region_id+","+e.feature.properties.product_id,n.href="#"+e.feature.properties.region_id+","+e.feature.properties.product_id,itemCount++,n.className="title global",n.setAttribute("data-toggle","modal"),n.setAttribute("data-target","#myModal"),n.setAttribute("data-title",e.feature.properties.title),n.setAttribute("data-img",e.feature.properties.product_jpg),n.setAttribute("data-href","#"+e.feature.properties.region_id+","+e.feature.properties.product_id)}else{var n=r.appendChild(document.createElement("a"));n.id="#"+e.feature.properties.region_id+","+e.feature.properties.product_id,n.href="#"+e.feature.properties.region_id+","+e.feature.properties.product_id,itemCount++,n.className="title",n.setAttribute("data-href","#"+e.feature.properties.region_id+","+e.feature.properties.product_id)}n.dataPosition=a,n.innerHTML=o;var l=new Date,c=(l.getDate(),l.setDate(l.getDate()-60));new Date(e.feature.properties.date_published)>c&&(n.innerHTML=o+'<span class="new-product"> new</span>');var d=r.appendChild(document.createElement("div"));$(s).appendTo(d);var p=function(e){var t=0,i=[];for(var a in e)e.hasOwnProperty(a)&&a.indexOf("product_jpg")>-1&&(++t,i.push(a));return i.sort(),{length:t,jpegArrayKeys:i}},g=p(e.feature.properties).length,m=p(e.feature.properties).jpegArrayKeys;if(g>1)for(console.log("inner loop!!"),$("div[title='"+t+"'] .dropdown-menu li:last-child a").text("JPG - page 1 of "+g),i=1;i<g;i++)console.log("printing JpegLength"),console.log(i),console.log("printing jpegArrayKey"),console.log(m[i]),console.log(e.feature.properties[m[i]]),$("div[title='"+t+"'] .dropdown-menu").append('<li><a class="jpg" onclick="ga(&apos;send&apos;, &apos;event&apos;, { eventCategory: &apos;JPG Product Download&apos;, eventAction: &apos;click&apos;, eventLabel: event.target.href, transport: &apos;beacon&apos; });" href="'+e.feature.properties[m[i]]+'">JPG - page '+(i+1)+" of "+g+"</a></li>");$(n).mouseover(function(){if(console.log("link mouseover: "),$(n).hasClass("global"));else{switch(activeLayer){case"AF":clickedListing=AFmarkers.getLayer(this.dataPosition);var e=AFmarkers.getVisibleParent(clickedListing);break;case"EAP":clickedListing=EAPmarkers.getLayer(this.dataPosition);var e=EAPmarkers.getVisibleParent(clickedListing);break;case"EUR":clickedListing=EURmarkers.getLayer(this.dataPosition);var e=EURmarkers.getVisibleParent(clickedListing);break;case"NEA":clickedListing=NEAmarkers.getLayer(this.dataPosition);var e=NEAmarkers.getVisibleParent(clickedListing);break;case"SCA":clickedListing=SCAmarkers.getLayer(this.dataPosition);var e=SCAmarkers.getVisibleParent(clickedListing);break;case"WHA":clickedListing=WHAmarkers.getLayer(this.dataPosition);var e=WHAmarkers.getVisibleParent(clickedListing)}if(e._iconObj){console.log(e._iconObj),console.log(e._iconObj.options);var t=e._iconObj.options.className+" glow1";window.productIconGlow=L.divIcon({className:t,html:e._iconObj.options.html,iconSize:e._iconObj.options.iconSize})}else{if(console.log("did selector work?"),console.log($(e._icon.className)),e._icon.className.indexOf("glow2")>=0){console.log("has class glow2");var t=e._icon.className}else var t=e._icon.className+" glow2";window.productIconGlow=L.divIcon({className:t,html:e._icon.innerHTML})}e.setIcon(productIconGlow)}}),$(n).mouseout(function(){if($(n).hasClass("global"));else{switch(activeLayer){case"AF":clickedListing=AFmarkers.getLayer(this.dataPosition);var e=AFmarkers.getVisibleParent(clickedListing);break;case"EAP":clickedListing=EAPmarkers.getLayer(this.dataPosition);var e=EAPmarkers.getVisibleParent(clickedListing);break;case"EUR":clickedListing=EURmarkers.getLayer(this.dataPosition);var e=EURmarkers.getVisibleParent(clickedListing);break;case"NEA":clickedListing=NEAmarkers.getLayer(this.dataPosition);var e=NEAmarkers.getVisibleParent(clickedListing);break;case"SCA":clickedListing=SCAmarkers.getLayer(this.dataPosition);var e=SCAmarkers.getVisibleParent(clickedListing);break;case"WHA":clickedListing=WHAmarkers.getLayer(this.dataPosition);var e=WHAmarkers.getVisibleParent(clickedListing)}if(e._icon.className.indexOf("glow2")>=0){console.log("get rid of glow2");var t=e._icon.className.replace("glow2","")}else var t=e._icon.className;e._iconObj?window.productIconNoGlow=L.divIcon({className:e._iconObj.options.className,html:e._iconObj.options.html,iconSize:e._iconObj.options.iconSize}):window.productIconNoGlow=L.divIcon({className:t,html:e._icon.innerHTML}),e.setIcon(productIconNoGlow)}}),$(n).click(function(){console.log("calling link click"),console.log("this.dataPosition: "),console.log(this.dataPosition);var e;switch(activeLayer){case"AF":e=AFmarkers.getLayer(this.dataPosition);break;case"EAP":e=EAPmarkers.getLayer(this.dataPosition);break;case"EUR":e=EURmarkers.getLayer(this.dataPosition);break;case"NEA":e=NEAmarkers.getLayer(this.dataPosition);break;case"SCA":e=SCAmarkers.getLayer(this.dataPosition);break;case"WHA":e=WHAmarkers.getLayer(this.dataPosition)}if($(n).hasClass("global")){$(".item").removeClass("active"),$('.item[id="item-'+this.dataPosition+'"]').addClass("active");var t=$('.item[id="item-'+this.dataPosition+'"]').parent().attr("class");$("."+t).prepend($('.item[id="item-'+this.dataPosition+'"]'))}else{switch(activeLayer){case"AF":AFmarkers.zoomToShowLayer(e,function(){e.openPopup()});break;case"EAP":EAPmarkers.zoomToShowLayer(e,function(){e.openPopup()});break;case"EUR":EURmarkers.zoomToShowLayer(e,function(){e.openPopup()});break;case"NEA":NEAmarkers.zoomToShowLayer(e,function(){e.openPopup()});break;case"SCA":SCAmarkers.zoomToShowLayer(e,function(){e.openPopup()});break;case"WHA":WHAmarkers.zoomToShowLayer(e,function(){e.openPopup()})}$(".item").removeClass("active"),$('.item[id="item-'+this.dataPosition+'"]').addClass("active");var t=$('.item[id="item-'+this.dataPosition+'"]').parent().attr("class");$("."+t).prepend($('.item[id="item-'+this.dataPosition+'"]')),selectedID=this.dataPosition}map.on("moveend",function(){console.log("map panned, what is selected id?"),console.log(selectedID),$('.item[id="item-'+selectedID+'"]').addClass("active");var e=$('.item[id="item-'+selectedID+'"]').parent().attr("class");$("."+e).prepend($('.item[id="item-'+selectedID+'"]'))})})}var u=L.DomUtil.create("li","list-markers-li");L.DomUtil.create("a","",u);return u},_updateList:function(){console.log("updateList called"),window.topoLayer.clearLayers(),map.getZoom()<=6&&addTopoData(),$(".product-listings").empty(),$(".AF-listings").empty(),$(".EAP-listings").empty(),$(".EUR-listings").empty(),$(".NEA-listings").empty(),$(".SCA-listings").empty(),$(".WHA-listings").empty(),console.log("global listing length"),console.log($(".global-listings").length),console.log($(".global-listings")),console.log($(".global-listings").children().length),$(".global-listings").children().length>1&&(globalProductsExist=!0);var e=this,t=0;marginPoint=new L.Point(-350,0),bounds=map.getPixelBounds(),bottomLeft=bounds.getBottomLeft(),topRight=bounds.getTopRight(),bounds=new L.LatLngBounds(map.unproject(bottomLeft.subtract(marginPoint)),map.unproject(topRight)),this._list.innerHTML="",this._layer.eachLayer(function(i){i instanceof L.Marker&&bounds.contains(i.getLatLng())&&++t<e.options.maxItems&&(0==globalProductsExist?e._list.appendChild(e._createItem(i)):"global"!=i.feature.properties.region_id&&(console.log("creating item"),e._list.appendChild(e._createItem(i))))}),console.log("global listing length2"),console.log($(".global-listings").length),console.log($(".global-listings")),console.log("update ended and selectedID is"),console.log(selectedID),$('.item[id="'+selectedID+'"]').addClass("active");var i=$('.item[id="'+selectedID+'"]').parent().attr("class");$("."+i).prepend($('.item[id="'+selectedID+'"]')),$(".tweet").on("click",function(){console.log("tweet clicked");var e=$(this).attr("href"),t=screen.width/2-275,i=screen.height/2-210;return window.open(e,"Share a link on Twitter","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=550, height=420, top="+i+", left="+t),!1})},_initToggle:function(){var e=this._container;if(e.setAttribute("aria-haspopup",!0),L.Browser.touch?L.DomEvent.on(e,"click",L.DomEvent.stopPropagation):L.DomEvent.disableClickPropagation(e),this.options.collapsed){this._collapse(),L.Browser.android||L.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var t=this._button=L.DomUtil.create("a","list-markers-toggle",e);t.href="#",t.title="List Markers",L.Browser.touch?L.DomEvent.on(t,"click",L.DomEvent.stop).on(t,"click",this._expand,this):L.DomEvent.on(t,"focus",this._expand,this),this._map.on("click",this._collapse,this)}},_expand:function(){this._container.className=this._container.className.replace(" list-markers-collapsed","")},_collapse:function(){L.DomUtil.addClass(this._container,"list-markers-collapsed")},_moveTo:function(e){this.options.maxZoom?this._map.flyTo(e,Math.min(this._map.getZoom(),this.options.maxZoom)):this._map.panTo(e)}}),L.control.listMarkers=function(e){},L.Map.addInitHook(function(){this.options.listMarkersControl&&(this.listMarkersControl=L.control.listMarkers(this.options.listMarkersControl))})}).call(this);